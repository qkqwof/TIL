## 페이징 시스템(paging system)

- 크기가 동일한 페이지로 가상 주소 공간과 이에 매칭하는 물리 주소 공간을 관리한다.
- 리눅스에서는 4KB로 paging한다.
- 페이지 번호를 기반으로 가상 주소/물리 주소 매핑 정보를 기록하고 사용한다.
- 하드웨어 지원이 필요하다.
<br>
- 프로세스(4GB)의 PCB에 Page Table 구조체를 가리키는 주소가 있다.
- Page Table에는 가상주소와 물리주소간 매핑 정보가 있다.

![페이징시스템](./img/페이징시스템.jpg)

그림을 보면 Page Table에 가상주소와 물리주소의 매핑 정보가 있어서 가상 메모리와 물리 메모리를 연결하는 역할을 한다.

#### 페이징 시스템 구조
- Page 또는 page frame: 고정된 크기의 block(4KB)
- paging system
    - 가상 주소 v = (p,d)
        - p: 가상 메모리 페이지
        - d: p 안에서 참조하는 위치(변위)

![가상주소](./img/가상주소.jpg)

페이지번호에는 물리주소를 기록한다. 
p + d => 실제 물리메모리의 해당 데이터 위치를 알 수 있다.

- 페이지 크기가 4KB의 예
    - 가상 주소의 0비트에서 11비트가 변위(d)를 나타낸다.
    - 12비트 이상이 페이지 번호가 될 수 있다.

#### 페이지 테이블(Page Table)
- page table
    - 물리 주소에 있는 페이지 번호와 해당 페이지의 첫 물리 주소 정보를 매핑한 표이다.
- Paging System 동작
    - 해당 프로세스에서 특정 가상 주소에 엑세스를 하려면...
        - 해당 프로세스의 page table에 해당 가상 주소가 포함된 page번호가 있는지 확인한다.
        - page번호가 있으면 이 page가 매핑된 첫 물리 주소를 알라내고(p') p' + d가 실제 물리 주소가 된다.

#### 페이징 시스템과 MMU
- CPU는 가상 주소 접근시 MMU 하드웨어 장치를 통해 물리 메모리에 접근한다.

![가상메모리](./img/가상메모리.jpg)

- 프로세스를 생성할 때, 페이지 테이블 정보를 생성한다.
- PCB 등에서 해당 페이지 테이블 접근이 가능하고, 관련 정보는 물리 메모리에 적재된다.
- 프로세스 가동시, 해당 페이지 테이블 base 주소가 별도 레지스터에 저장된다.(CR3)
- CPU가 가상 주소 접근시, MMU가 페이지 테이블 base 주소를 접근해서 물리 주소를 가져온다.

