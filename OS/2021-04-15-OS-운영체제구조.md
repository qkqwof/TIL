## 시스템콜

#### 응용 프로그램, 운영체제, 컴퓨터 하드웨어(System Resource) 관계
- 도서관으로 비유하면
**운영체제** -> 도서관
**응용 프로그램** -> 시민
**컴퓨터 하드웨어** -> 책
<br>
- 운영체제의 역할
    - 운영체제는 응용프로그램이 요청하는 메모리를 **허가**, **분배**
    - 운영체제는 응용프로그램이 요청하는 **CPU시간**을 제공
    - 운영체제는 응용프로그램이 요청하는 **IO Devices 사용을 허가 및 제어**

**운영체제는 사용자 인터페이스를 제공하고 응용 프로그램을 위한 인터페이스를 제공한다.**
- 쉘
    - 사용자가 운영체제 기능과 서비스를 조작할 수 있도록 인터페이스를 제공하는 프로그램
    - CLI와 GUI 환경
- API
    - Application Programming InterFace
    - 응용 프로그램에서 사용할 수 있도록, 운영 체제나 프로그래밍 언어가 제공하는 기능을 제어할 수 있게 만든 인터페이스
- 라이브러리
- 시스템콜(시스템 호출 인터페이스)
    - 운영체제가 각 기능을 사용할 수 있도록 시스템 콜이라는 명령 또는 함수를 제공

**보통 시스템 콜을 직접 사용하기 보다는, 해당 시스템 콜을 사용해서 만든 각 언어별 라이브러리를 사용한다.**

전체적인 구조

![구조3](https://user-images.githubusercontent.com/76687078/114837306-856a5080-9e0e-11eb-88ac-7e5bc5c56e37.png)

## 사용자 모드와 커널 모드

**CPU의 권한 모드**
- 사용자 모드
    - 사용자가 어플리케이션을 이용함에 있어서 사용하는 모드
    - 응용 프로그램이 사용
- 커널 모드
    - 특정한 명령어 실행과 원하는 작업 수행을 위한 자원 접근을 가능하게 하는 모드
    - OS가 사용 

**응용 프로그램과 운영체제**

![시스템콜](https://user-images.githubusercontent.com/76687078/114843357-b5b4ed80-9e14-11eb-8722-b4101ce1744f.jpg)

- 예시

    1. 1~1000까지 더하기
    2. 파일에서 데이터 가져오기
    3. 해당 데이터와 1~1000 더한 값을 출력한다.

1번과 3번은 사용자 영역에서 응용프로그램이 처리하지만 2번의 경우, 커널 영역에서 수행 한 후 응용 프로그램에 전달한다.

**시스템콜은 운영체제가 제공하고 커널 모드를 실행하려면 반드시 시스템콜을 사용해야 한다**
<br>
**C언어 코드 예시**

![c언어코드](https://user-images.githubusercontent.com/76687078/114844415-c023b700-9e15-11eb-84bd-1309236fdf1c.jpg)

운영체제는 시스템콜을 제공하고 시스템콜을 기반으로 API를 제공한다. 응용 프로그램은 운영체제 기능 필요시, 해당 API를 사용해서 프로그램을 작성한다. 
응용프로그램이 실행돼서, 운영체제 기능이 필요한 API를 호출하면 시스템 콜이 호출되어서, 커널모드로 변경되어 OS내부에서 해당 명령이 실행되고, 다시 응용 프로그램으로 돌아간다.